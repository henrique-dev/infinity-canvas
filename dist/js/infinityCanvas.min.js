!function(b,a){"object"==typeof exports&&"undefined"!=typeof module?a(exports):"function"==typeof define&&define.amd?define(["exports"],a):a((b="undefined"!=typeof globalThis?globalThis:b||self).ICanvas={})}(this,a=>{let b=function(c,...a){let d=a.length>0&& void 0!==a[0]?a[0]:{};return new b.InfinityCanvas(c,d)},d=!0,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;function H(){e=n.getBoundingClientRect().width,f=n.getBoundingClientRect().height}function I(){return{globalAlpha:this.globalAlpha,lineWidth:this.lineWidth,lineCap:this.lineCap,strokeStyle:this.strokeStyle,fillStyle:this.fillStyle,font:this.font}}function J(b,i={},j={}){let k=this.getCurrentOptionsOfCanvasContext(),a={translate:null,fixXY:null,drawAndFill:null,positionFixed:!1,...j},c=a.positionFixed?b.x:b.x-u.x,d=a.positionFixed?b.y:b.y-u.y;if(Object.keys(i).forEach(a=>{this[a]=i[a]}),a.translate&&this.translate(a.translate.x,a.translate.y),a.fixXY){let e=parseInt(c,10)+a.fixXY,f=parseInt(d,10)+a.fixXY,g=parseInt(b.w,10)+a.fixXY,h=parseInt(b.h,10)+a.fixXY;a.drawAndFill?(this.strokeRect(e,f,g,h),this.fillRect(e,f,g,h)):this.strokeRect(e,f,g,h)}else a.drawAndFill?(this.strokeRect(c,d,b.w,b.h),this.fillRect(c,d,b.w,b.h)):this.strokeRect(c,d,b.w,b.h);Object.keys(k).forEach(a=>{this[a]=k[a]}),a.translate&&this.setTransform(1,0,0,1,0,0)}function K(b,i={},j={}){let k=this.getCurrentOptionsOfCanvasContext(),a=Object.apply({translate:null,fixXY:null,drawAndFill:null,positionFixed:!1},j),c=a.positionFixed?b.x:b.x-u.x,d=a.positionFixed?b.y:b.y-u.y;if(Object.keys(i).forEach(a=>{this[a]=i[a]}),a.translate&&this.translate(a.translate.x,a.translate.y),a.fixXY){let e=parseInt(c,10)+a.fixXY,f=parseInt(d,10)+a.fixXY,g=parseInt(b.w,10)+a.fixXY,h=parseInt(b.h,10)+a.fixXY;a.drawAndFill&&this.strokeRect(e,f,g,h),this.fillRect(e,f,g,h)}else a.drawAndFill&&this.strokeRect(c,d,b.w,b.h),this.fillRect(c,d,b.w,b.h);Object.keys(k).forEach(a=>{this[a]=k[a]}),a.translate&&this.setTransform(1,0,0,1,0,0)}function L(){this.clearRect(0,0,o.width,o.height)}function M(a){let b=a.x,c=a.x+a.width,d=u.x,e=u.x+u.width,f=a.y,g=a.y+a.height,h=u.y,i=u.y+u.height;return(b>=d&&b<=e||c>=d&&c<=e)&&(f>=h&&f<=i||g>=h&&g<=i)}function N(){o.cameraArea.x<0&&(o.cameraArea.x=0),o.cameraArea.y<0&&(o.cameraArea.y=0),o.context.strokeStyle="#000",o.context.lineWidth=1,o.context.fillStyle="#FFF",o.context.fillRect(v.x,v.y,v.width,v.height),y(o)&&G.forEach(b=>{let a={x:0,y:0,width:0,height:0,type:"none",contextOptions:{},elementOptions:{},...b};if(M(b)){let c={globalAlpha:0,fillStyle:"#FFFFFF",...a.contextOptions},d={translate:null,fixXY:null,drawAndFill:null,positionFixed:!1,...a.elementOptions};switch(a.type){case"draw":o.context.ICdrawRect({x:a.x,y:a.y,w:a.width,h:a.height},c,d);break;case"draw_and_fill":o.context.ICfillRect({x:a.x,y:a.y,w:a.width,h:a.height},c,d)}}}),o.context.fillStyle="#F5F5F5",o.context.strokeStyle="#fff"}function O(a){let b=a.deltaY/10,c=a.deltaX/10;return p.scroll(p.scrollLeft+c,p.scrollTop+b),o.cameraArea.y=p.scrollTop,a}function P(a){return o.cameraArea.y=this.scrollTop,z(this.scrollLeft,this.scrollTop),a}function Q(a){return o.cameraArea.x=this.scrollLeft,z(this.scrollLeft,this.scrollTop),a}function R(){let a=document.createElement("div");a.style.visibility="hidden",a.style.width="100px",a.style.msOverflowStyle="scrollbar",document.body.appendChild(a);let c=a.offsetWidth;a.style.overflow="scroll";let b=document.createElement("div");b.style.width="100%",a.appendChild(b);let d=b.offsetWidth;return a.parentNode.removeChild(a),c-d}function S(){g=e-(k=R()),h=f-k,l=e-k,m=f-k,u={x:0,y:0,width:g,height:h},v={x:0,y:0,width:g,height:h},n.textContent="",n.style.position="relative",n.style.padding="0px",n.style.margin="0px",o=document.createElement("canvas"),o.width=g,o.height=h,o.style.position="absolute",o.style.left="0px",o.style.top="0px",d&&(o.style.background="rosybrown"),n.appendChild(o),p=document.createElement("div"),p.style.position="absolute",p.style.right="0px",p.style.top="0px",p.style.height=`${m}px`,p.style["overflow-y"]="scroll";let a=document.createElement("div");a.style.width="1px",a.style.height=`${j}px`,p.appendChild(a),n.appendChild(p),(q=document.createElement("div")).style.position="absolute",q.style.left="0px",q.style.bottom="0px",q.style.width=`${l}px`,q.style["overflow-x"]="scroll";let b=document.createElement("div");b.style.height="1px",b.style.width=`${i}px`,q.appendChild(b),n.appendChild(q),(r=document.createElement("div")).style.position="absolute",r.style.right="0px",r.style.bottom="0px",r.style.background="#dcdcdc",r.style.width=`${k}px`,r.style.height=`${k}px`,n.appendChild(r),n.onResize=A,n.onMouseMove=B,n.onMouseEnter=C,n.onMouseUp=D,n.onMouseDown=E,n.onClick=F}function T(b){let a="default";G.forEach(c=>{b.offsetX>=c.x-u.x&&b.offsetX<=c.x+c.width-u.x&&b.offsetY>=c.y-u.y&&b.offsetY<=c.y+c.height-u.y&&(a="pointer")}),o.style.cursor=a}function U(){null!=w&&clearInterval(w)}function V(){o.context=o.getContext("2d"),o.cameraArea=u,o.drawArea=v,o.context.getCurrentOptionsOfCanvasContext=I,o.frameNo=0,s=j/h,o.fatScrollY=s,t=i/g,o.fatScrollX=t,o.clear=L,o.context.ICdrawRect=J,o.context.ICfillRect=K,U(),w=setInterval(N,x),o.intervalID=w,q.addEventListener("scroll",Q,!1),p.addEventListener("scroll",P,!1),o.addEventListener("wheel",O,!1),o.addEventListener("mousemove",T,!1)}function W(b){let a={debug:!1,drawWidth:0,drawHeight:0,refreshRate:100,onDraw:()=>!0,onScroll:()=>!0,onResize:()=>!0,onMouseMove:()=>!0,onMouseEnter:()=>!0,onMouseUp:()=>!0,onMouseDown:()=>!0,onClick:()=>!0,elements:[],...b};d=a.debug,i=a.drawWidth,j=a.drawHeight,x=a.refreshRate,y=a.onDraw,z=a.onScroll,A=a.onResize,B=a.onMouseMove,C=a.onMouseEnter,D=a.onMouseUp,E=a.onMouseDown,F=a.onClick,G=a.elements}function X(a){return"DIV"===a.tagName}function Y(){H(),S(),V()}function Z(){Y()}let c=function(a,b){X(a)&&(n=a,W(b),Y(),this.resizeElement=Z,window.addEventListener("resize",Z,!1))};b.InfinityCanvas=c;try{globalThis.ICanvas=b}catch($){}a.InfinityCanvas=c,a.default=b,Object.defineProperty(a,"__esModule",{value:!0})})
